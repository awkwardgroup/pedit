var PEDIT=PEDIT||{};PEDIT={mouseStartX:0,mouseStartY:0,mouseEndX:0,mouseEndY:0,init:function(a){var b=document.getElementById(a);return new PEDIT.Editor(b)},Editor:function(a){var b=this;b.element=a,b.width=a.offsetWidth,b.height=a.offsetHeight,b.offset=0,b.remove=!0,b.resize=!0,b.percent=!0,b.updateChildMaxSize=!0,b.childMaxWidth=0,b.childMaxHeight=0,b.childMinWidth=10,b.childMinHeight=10,b.childTrailID=1,b.children=[],b.element.onmousedown=function(a){PEDIT.mouseStartX=a.x,PEDIT.mouseStartY=a.y,PEDIT.mouseEndX=a.x,PEDIT.mouseEndY=a.y,b.width=b.element.offsetWidth,b.height=b.element.offsetHeight,b.updateChildMaxSize&&(b.childMaxWidth=100,b.childMaxHeight=100)},b.render=function(){for(var a=b.element.children,c=[],d=0,e=a.length;e>d;d++)a[d].getAttribute("data-child-id")||c.push(a[d]);for(d=0;d<c.length;d++)b.addChild(c[d])},b.addChild=function(a){var c=new PEDIT.Child(b,a,b.childTrailID);return b.children[b.childTrailID]=c,a.setAttribute("data-child-id",b.childTrailID),b.childTrailID++,c},b.calculateSize=function(a,c){var d=a/(b.width-b.offset)*100;return c||(d=a/(b.height-b.offset)*100),d}},Child:function(a,b,c){var d=this;d.id=c,d.element=b,d.elementResize=null,d.elementRemove=null,d.editor=a,d.width=a.calculateSize(b.offsetWidth,!0),d.height=a.calculateSize(b.offsetHeight,!1),d.offsetX=a.calculateSize(b.offsetLeft,!0),d.offsetY=a.calculateSize(b.offsetTop,!1),d.locked=!1,d.editor.resize&&(d.elementResize=document.createElement("div"),d.elementResize.className="resize",d.element.appendChild(d.elementResize)),d.editor.remove&&(d.elementRemove=document.createElement("div"),d.elementRemove.className="remove",d.element.appendChild(d.elementRemove)),d.element.onmousedown=function(){d.updateOffsetLimits(),d.move()},d.elementResize&&(d.elementResize.onmousedown=function(){d.locked=!0,d.resize()}),d.elementRemove&&(d.elementRemove.onmousedown=function(){d.locked=!0,d.elementRemove.onmouseup=function(){d.remove()},document.onmouseup=function(){d.elementRemove.onclick=null,d.locked=!1}}),d.updateOffsetLimits=function(){d.offsetLimitX=100-d.width,d.offsetLimitY=100-d.height},d.move=function(){var b=d.offsetX,c=d.offsetY;d.locked||(document.onmousemove=function(e){PEDIT.mouseEndX=e.x,PEDIT.mouseEndY=e.y,b=d.offsetX+a.calculateSize(PEDIT.mouseEndX-PEDIT.mouseStartX,!0),b=0>b?0:b,b=b>d.offsetLimitX?d.offsetLimitX:b,d.element.style.left=b+"%",c=d.offsetY+a.calculateSize(PEDIT.mouseEndY-PEDIT.mouseStartY,!1),c=0>c?0:c,c=c>d.offsetLimitY?d.offsetLimitY:c,d.element.style.top=c+"%"},document.onmouseup=function(){document.onmousemove=null,d.offsetX=b,d.offsetY=c})},d.resize=function(){document.onmousemove=function(b){PEDIT.mouseStartX=b.x,PEDIT.mouseStartY=b.y;var c=d.height/d.width,e=PEDIT.mouseStartX-PEDIT.mouseEndX,f=e*e,g=PEDIT.mouseStartY-PEDIT.mouseEndY,h=g*g,i=1.5*Math.sqrt(f+h);i=e>=0&&g>=0?i:-i;var j=d.width+a.calculateSize(i,!0),k=c*j;d.updateElementSize(j,k),PEDIT.mouseEndX=b.x,PEDIT.mouseEndY=b.y},document.onmouseup=function(){document.onmousemove=null,d.locked=!1}},d.updateElementSize=function(a,b){if(!(a>d.editor.childMaxWidth||a<d.editor.childMinWidth||b>d.editor.childMaxHeight||b<d.editor.childMinHeight)){var c=a-d.width,e=b-d.height;c>0?(d.width=a>99?100:a,d.height=b>99?100:b):(d.width=a,d.height=b),d.updateOffsetLimits(),d.element.style.width=d.width+"%",d.element.style.height=d.height+"%";var f=d.offsetX-c/2,g=d.offsetY-e/2;d.updateElementPosition(f,g)}},d.updateElementPosition=function(a,b){a=0>a?0:a>d.offsetLimitX?d.offsetLimitX:a,b=0>b?0:b>d.offsetLimitY?d.offsetLimitY:b,d.element.style.left=a+"%",d.element.style.top=b+"%",d.offsetX=a,d.offsetY=b},d.remove=function(){d.editor.element.removeChild(d.element),d.editor.children.splice(d.id,1)}}};